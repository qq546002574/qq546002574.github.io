(function(){"use strict";var t={87657:function(t,e,a){var r=a(46648),i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("DataTable")],1)},n=[],l=function(){var t=this,e=t._self._c;return e("div",{staticClass:"data-table"},[e("el-tabs",{attrs:{type:"card"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:"供应商数据",name:"datas"}},[e("div",{staticClass:"search-area"},[e("el-form",{attrs:{inline:!0,model:t.searchForm}},[e("el-form-item",{attrs:{label:"厂商"}},[e("el-select",{attrs:{placeholder:"请选择厂商",multiple:"",clearable:""},model:{value:t.searchForm.vendor,callback:function(e){t.$set(t.searchForm,"vendor",e)},expression:"searchForm.vendor"}},t._l(t.vendorOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{attrs:{placeholder:"请输入名称",clearable:""},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),e("el-form-item",{attrs:{label:"料号"}},[e("el-input",{attrs:{placeholder:"请输入料号",clearable:""},model:{value:t.searchForm.materialNo,callback:function(e){t.$set(t.searchForm,"materialNo",e)},expression:"searchForm.materialNo"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("查询")]),e("el-button",{on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1),e("div",{staticClass:"table-operations"},[e("el-button",{attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("新增")]),e("el-button",{attrs:{type:"primary"},on:{click:t.exportData}},[t._v("导出Excel")]),e("el-button",{attrs:{type:"primary"},on:{click:t.triggerImport}},[t._v("导入Excel")]),e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:t.importData}})],1),e("vxe-table",{attrs:{data:t.tableData,height:400,border:"","show-header":"","show-overflow":""}},[t._l(t.tableColumns,(function(t){return e("vxe-column",{key:t.field,attrs:{field:t.field,title:t.title}})})),e("vxe-column",{attrs:{title:"操作",width:"150",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.handleEdit(a)}}},[t._v(" 编辑 ")]),e("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text",size:"small"},on:{click:function(e){return t.handleDelete(a)}}},[t._v(" 删除 ")])]}}])})],2)],1),e("el-tab-pane",{attrs:{label:"供应商数据分析",name:"analysis"}},[e("div",{staticClass:"chart-container"},[e("div",{ref:"defectChart",staticClass:"chart"})])]),e("el-tab-pane",{attrs:{label:"最高不良率的物料品种排序柱状图",name:"echart"}},[e("div",{staticClass:"chart-container"},[e("div",{ref:"materialDefectChart",staticClass:"chart"})])])],1),e("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("el-form",{ref:"form",attrs:{model:t.formData,"label-width":"120px"}},t._l(t.tableColumns,(function(a){return e("el-form-item",{key:a.field,attrs:{label:a.title}},["厂家"!==a.field?e("el-input",{model:{value:t.formData[a.field],callback:function(e){t.$set(t.formData,a.field,e)},expression:"formData[col.field]"}}):e("el-select",{attrs:{placeholder:"请选择厂家",filterable:"","allow-create":"","default-first-option":""},model:{value:t.formData[a.field],callback:function(e){t.$set(t.formData,a.field,e)},expression:"formData[col.field]"}},t._l(t.vendorOptions,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)})),1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.handleSave}},[t._v("确 定")])],1)],1)],1)},o=[],s=(a(44114),a(16573),a(78100),a(77936),a(18111),a(22489),a(7588),a(61701),a(18237),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698),a(37467),a(44732),a(79577),a(32700)),c=a(50676),h=a(94328),d={name:"DataTable",data(){return{activeTab:"datas",tableData:[],tableColumns:[],dialogVisible:!1,dialogTitle:"",formData:{},editingIndex:-1,searchForm:{vendor:"",name:"",materialNo:""},originalTableData:[],vendorOptions:[],chart:null}},watch:{activeTab(t){"analysis"!==t&&"echart"!==t||this.$nextTick((()=>{this.initChart(),this.initMaterialChart()}))},tableData:{handler(){"analysis"!==this.activeTab&&"echart"!==this.activeTab||(this.updateChart(),this.updateMaterialChart())},deep:!0}},methods:{exportData(){const t=c.Wp.json_to_sheet(this.tableData),e=c.Wp.book_new();c.Wp.book_append_sheet(e,t,"供应商数据");const a=c.M9(e,{bookType:"xlsx",type:"array"}),r=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,s.saveAs)(r,`供应商数据${(new Date).toLocaleDateString()}.xlsx`)},handleReset(){this.searchForm={vendor:"",name:"",materialNo:""},this.tableData=[...this.originalTableData]},importData(t){const e=t.target.files[0];if(!e)return;const a=new FileReader;a.onload=t=>{try{const e=new Uint8Array(t.target.result),a=c.LF(e,{type:"array"}),r=a.Sheets[a.SheetNames[0]],i=c.Wp.decode_range(r["!ref"]),n=[];for(let t=i.s.c;t<=i.e.c;++t){const e=r[c.Wp.encode_cell({r:0,c:t})];n.push(e?e.v:"")}this.tableColumns=n.filter(Boolean).map((t=>({field:t,title:t})));const l=c.Wp.sheet_to_json(r);this.tableData=l,this.originalTableData=[...l];const o=new Set(l.map((t=>t["厂家"])).filter(Boolean));this.vendorOptions=Array.from(o),0===l.length?this.$message.warning("Excel文件中没有数据，但已加载表头！"):this.$message.success("数据导入成功！")}catch(e){console.error("导入失败：",e),this.$message.error("导入失败，请检查文件格式是否正确！")}},a.readAsArrayBuffer(e),t.target.value=""},triggerImport(){this.$refs.fileInput.click()},handleAdd(){this.dialogTitle="新增数据",this.formData=this.tableColumns.reduce(((t,e)=>(t[e.field]="",t)),{}),this.editingIndex=-1,this.dialogVisible=!0},handleEdit(t){this.dialogTitle="编辑数据",this.formData={...t},this.editingIndex=this.tableData.indexOf(t),this.dialogVisible=!0},handleDelete(t){this.$confirm("确认删除该条数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=this.tableData.indexOf(t);this.tableData.splice(e,1),this.$message.success("删除成功")})).catch((()=>{this.$message.info("已取消删除")}))},handleSave(){if(this.editingIndex>-1){this.$set(this.tableData,this.editingIndex,{...this.formData});const t=this.originalTableData.findIndex((t=>t===this.tableData[this.editingIndex]));t>-1&&this.$set(this.originalTableData,t,{...this.formData})}else this.tableData.push({...this.formData}),this.originalTableData.push({...this.formData});this.updateVendorOptions(),this.dialogVisible=!1,this.$message.success(this.editingIndex>-1?"修改成功":"添加成功")},handleSearch(){if(!this.searchForm.vendor.length&&!this.searchForm.name.length&&!this.searchForm.materialNo.length)return void(this.tableData=[...this.originalTableData]);const t=this.originalTableData.filter((t=>{const e=this.searchForm.vendor.includes(t["厂家"]),a=this.searchForm.name.includes(t["名称"]),r=this.searchForm.materialNo.includes(t["料号"]);return e||a||r}));this.tableData=t,0===t.length&&this.$message.warning("未找到匹配的数据")},updateVendorOptions(){const t=new Set(this.originalTableData.map((t=>t.vendor)).filter(Boolean));this.vendorOptions=Array.from(t)},initChart(){this.chart&&this.chart.dispose(),this.chart=h.Ts(this.$refs.defectChart),this.updateChart()},updateChart(){if(!this.chart)return;const t={};this.tableData.forEach((e=>{t[e["厂家"]]||(t[e["厂家"]]=[]);const a=parseFloat(e["不良率"])||0;t[e["厂家"]].push(a)}));const e=Object.keys(t),a=e.map((e=>{const a=t[e],r=a.reduce(((t,e)=>t+e),0)/a.length;return{vendor:e,rate:parseFloat(r.toFixed(2))}}));a.sort(((t,e)=>e.rate-t.rate));const r={title:{text:"供应商不良率分析",left:"center"},tooltip:{trigger:"axis",formatter:"{b}: {c}%"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:a.map((t=>t.vendor)),axisLabel:{interval:0,rotate:45}},yAxis:{type:"value",name:"不良率(%)",axisLabel:{formatter:"{value}%"}},series:[{name:"不良率",type:"line",data:a.map((t=>t.rate)),markLine:{data:[{type:"average",name:"平均值"}]},label:{show:!0,position:"top",formatter:"{c}%"},smooth:!0,symbol:"circle",symbolSize:8,itemStyle:{color:"#409EFF"},areaStyle:{color:new h.fA.W4(0,0,0,1,[{offset:0,color:"rgba(64,158,255,0.3)"},{offset:1,color:"rgba(64,158,255,0.1)"}])}}]};this.chart.setOption(r)},initMaterialChart(){this.chart&&this.chart.dispose(),this.chart=h.Ts(this.$refs.materialDefectChart),this.updateMaterialChart()},updateMaterialChart(){if(!this.chart)return;const t=this.tableData.reduce(((t,e)=>{const a=`${e["料号"]}-${e["名称"]}`;if(t[a]){const r=parseFloat(e["不良率"])||0;r>t[a].defectRate&&(t[a].defectRate=r)}else t[a]={vendor:e["厂家"],batch:e["批次"],defectReason:e["来料不良(IQC)5%质量问题"]||e["产线不良生产线"]||"",defectRate:parseFloat(e["不良率"])||0,materialNo:e["料号"],name:e["名称"]};return t}),{}),e=Object.values(t).sort(((t,e)=>e.defectRate-t.defectRate)).slice(0,20),a={title:{text:"物料不良率TOP20排序",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"line"},formatter:function(t){const a=t[0];return`厂家：${e[a.dataIndex].vendor}<br/>\n                    批次：${e[a.dataIndex].batch}<br/>\n                    料号：${e[a.dataIndex].materialNo}<br/>\n                    ${e[a.dataIndex].defectReason}<br/>\n                    名称：${e[a.dataIndex].name}<br/>\n                    不良率：${a.value}`}},grid:{left:"3%",right:"4%",bottom:"15%",containLabel:!0},xAxis:{type:"category",data:e.map((t=>t.materialNo)),axisLabel:{interval:0,rotate:45,formatter:function(t){return t.length>10?t.substring(0,10)+"...":t}}},yAxis:{type:"value",name:"不良率",axisLabel:{formatter:"{value}"}},series:[{name:"不良率",type:"line",data:e.map((t=>t.defectRate)),label:{show:!0,position:"top",formatter:"{c}"},smooth:!0,symbol:"circle",symbolSize:8,itemStyle:{color:"#409EFF"},lineStyle:{width:3},areaStyle:{color:new h.fA.W4(0,0,0,1,[{offset:0,color:"rgba(64,158,255,0.3)"},{offset:1,color:"rgba(64,158,255,0.1)"}])},markLine:{data:[{type:"average",name:"平均值",label:{formatter:"平均值: {c}"}}]}}]};this.chart.setOption(a)}},mounted(){window.addEventListener("resize",(()=>{this.chart&&this.chart.resize()}))},beforeDestroy(){this.chart&&(this.chart.dispose(),this.chart=null),window.removeEventListener("resize",this.handleResize)}},f=d,u=a(845),m=(0,u.A)(f,l,o,!1,null,"2bb0c8fe",null),p=m.exports,b={name:"App",components:{DataTable:p}},v=b,g=(0,u.A)(v,i,n,!1,null,null,null),y=g.exports,x=a(75922),D=a.n(x),w=a(50079),T=a.n(w);r["default"].use(D()),r["default"].use(T()),new r["default"]({render:t=>t(y)}).$mount("#app")}},e={};function a(r){var i=e[r];if(void 0!==i)return i.exports;var n=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,r,i,n){if(!r){var l=1/0;for(h=0;h<t.length;h++){r=t[h][0],i=t[h][1],n=t[h][2];for(var o=!0,s=0;s<r.length;s++)(!1&n||l>=n)&&Object.keys(a.O).every((function(t){return a.O[t](r[s])}))?r.splice(s--,1):(o=!1,n<l&&(l=n));if(o){t.splice(h--,1);var c=i();void 0!==c&&(e=c)}}return e}n=n||0;for(var h=t.length;h>0&&t[h-1][2]>n;h--)t[h]=t[h-1];t[h]=[r,i,n]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,r){var i,n,l=r[0],o=r[1],s=r[2],c=0;if(l.some((function(e){return 0!==t[e]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(s)var h=s(a)}for(e&&e(r);c<l.length;c++)n=l[c],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(h)},r=self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=a.O(void 0,[504],(function(){return a(87657)}));r=a.O(r)})();
//# sourceMappingURL=app.55f09ba6.js.map